"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[690],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return f}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),c=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=c(e.components);return a.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),g=c(n),f=r,u=g["".concat(p,".").concat(f)]||g[f]||s[f]||i;return n?a.createElement(u,l(l({ref:t},m),{},{components:n})):a.createElement(u,l({ref:t},m))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=g;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var c=2;c<i;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},7537:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return c},toc:function(){return m},default:function(){return g}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),l=["components"],o={title:"Charmil Config Management Package",slug:"/charmil_config"},p="Charmil Config Management Package",c={unversionedId:"charmil_config",id:"charmil_config",isDocsHomePage:!1,title:"Charmil Config Management Package",description:"The Charmil Config package offers a convenient mechanism for both host and plugin developers to manage configurations in their command-line interface (CLI) applications made using Cobra.",source:"@site/../docs/src/charmil_config.md",sourceDirName:".",slug:"/charmil_config",permalink:"/charmil/docs/charmil_config",version:"current",frontMatter:{title:"Charmil Config Management Package",slug:"/charmil_config"},sidebar:"main",previous:{title:"Charmil Factory",permalink:"/charmil/docs/charmil_factory"},next:{title:"Charmil Localization",permalink:"/charmil/docs/charmil_localization"}},m=[{value:"Features:",id:"features",children:[]},{value:"Steps to Use:",id:"steps-to-use",children:[]},{value:"Here&#39;s an example for the same:",id:"heres-an-example-for-the-same",children:[]}],s={toc:m};function g(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"charmil-config-management-package"},"Charmil Config Management Package"),(0,i.kt)("p",null,"The Charmil Config package offers a convenient mechanism for both host and plugin developers to manage configurations in their command-line interface (CLI) applications made using ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/spf13/cobra"},"Cobra"),"."),(0,i.kt)("h2",{id:"features"},"Features:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Helps in maintaining all available configurations in a single, centralized local config file."),(0,i.kt)("li",{parentName:"ul"},"Provides the plugin developers with a functionality to add their CLI configurations to the host CLI local config file with ease."),(0,i.kt)("li",{parentName:"ul"},"Provides the host CLI developers with a set of methods to read/write configurations from/to a local config file.")),(0,i.kt)("h2",{id:"steps-to-use"},"Steps to Use:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("h3",{parentName:"li",id:"for-host-cli-developers"},"For host CLI developers:"),(0,i.kt)("ol",{parentName:"li"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the file where the root command of your CLI is defined using Cobra.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Import the Charmil Config package by adding the following line at the top of that file:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'import c "github.com/aerogear/charmil/core/config"\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Define a struct whose fields represent the keys to all the values that you want to store as config and create an instance of it."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Important"),": Every field of the defined struct needs to be exportable (ie. start with an uppercase letter). The unexportable fields cannot be stored as config."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},"type config struct {\n  Key1 string\n  Key2 string\n  Key3 string\n  Key4 string\n}\n\ncfg = &config{}\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Store a new instance of the Charmil Config handler by calling the ",(0,i.kt)("inlineCode",{parentName:"p"},"NewHandler")," function while passing the path of local config file and the instance of the config struct (initialized in the last step) as arguments."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'h = c.NewHandler("./examples/host/config.json", cfg)\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Load config values from the local config file using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Load")," method."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},"err := h.Load()\nif err != nil {\n    log.Fatal(err)\n}\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"You can set/get/modify values under any key of config using the idiomatic way to interact with structs in Golang."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// Sets a value into config\ncfg.Key4 = "val4"\n\n// Overwrites a value in config\ncfg.Key2 = "newVal2"\n\n// Returns the value under specified key in config\nfmt.Println(cfg.Key3) // Prints: val3\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Write current config into the local config file using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Save")," method."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},"err = h.Save()\nif err != nil {\n  log.Fatal(err)\n}\n"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("h3",{parentName:"li",id:"for-plugin-developers"},"For plugin developers:"),(0,i.kt)("ol",{parentName:"li"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the file where the root command of your CLI is defined using Cobra.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Import the Charmil Config package by adding the following line at the top of that file:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'import c "github.com/aerogear/charmil/core/config"\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Define a struct whose fields represent the keys to all the values that you want to store as config and create an instance of it.\n",(0,i.kt)("strong",{parentName:"p"},"Important"),": Every field of the defined struct needs to be exportable (ie. start with an uppercase letter). The unexportable fields cannot be stored as config."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},"type config struct {\n  Key5 string\n  Key6 string\n  Key7 string\n  Key8 string\n}\n\ncfg = &config{}\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"You can set/get/modify values under any key of config using the idiomatic way to interact with structs in Golang."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// Sets values into config\ncfg.Key5 = "val5"\ncfg.Key6 = "val6"\ncfg.Key7 = "oldVal7"\ncfg.Key8 = "val8"\n\n// Overwrites a value in config\ncfg.Key7 = "val7"\n\n// Returns the value under specified key in config\nfmt.Println(cfg.Key6) // Prints: val6\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"MergePluginCfg")," function to merge the current plugin config into the host CLI config struct."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},"Example:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},"err = c.MergePluginCfg(pluginName, h, cfg)\nif err != nil {\n    log.Fatal(err)\n}\n")),(0,i.kt)("p",{parentName:"li"},"where ",(0,i.kt)("inlineCode",{parentName:"p"},"pluginName")," is the name of the plugin (as you want it in the local config file), ",(0,i.kt)("inlineCode",{parentName:"p"},"h")," is the config handler passed from the host CLI and ",(0,i.kt)("inlineCode",{parentName:"p"},"cfg")," is a pointer to an instance of the current config file (initialized in step 3)."))))),(0,i.kt)("h2",{id:"heres-an-example-for-the-same"},"Here's an example for the same:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("h4",{parentName:"li",id:"initial-configurations-before-running-the-host-cli"},"Initial Configurations ","[Before running the Host CLI]",":"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("em",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"em"},"config.json"))," file:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key1": "val1",\n  "key2": "val2",\n  "key3": "val3"\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Plugin A's Config Struct:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},"{val4 val5 val6}\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Plugin B's Config Struct:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},"{val7 val8 val9}\n"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("h4",{parentName:"li",id:"final-configurations-after-running-the-host-cli"},"Final Configurations ","[After running the Host CLI]",":"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"em"},"config.json"))," file:",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "key1": "val1",\n  "key2": "val2",\n  "key3": "val3",\n  "plugins": {\n    "pluginA": {\n      "Key4": "val4",\n      "Key5": "val5",\n      "Key6": "val6"\n    },\n    "pluginB": {\n      "Key7": "val7",\n      "Key8": "val8",\n      "Key9": "val9"\n    }\n  }\n}\n')))))))}g.isMDXComponent=!0}}]);